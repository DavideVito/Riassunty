select `riassunti`.`IDRiassunto` AS `IDRiassunto`,`riassunti`.`Titolo` AS `Titolo`,`riassunti`.`UrlPDF` AS `UrlPDF`,`riassunti`.`UrlIMG` AS `UrlIMG`,`riassunti`.`IDMateria` AS `IDMateria`,`riassunti`.`Anno` AS `Anno`,`riassunti`.`DataPubblicazione` AS `DataPubblicazione`,avg(`valutazioni`.`Valutazione`) AS `Val` from (`riassunti` left join `valutazioni` on((`riassunti`.`IDRiassunto` = `valutazioni`.`IDRiassunto`))) group by `riassunti`.`IDRiassunto`,`riassunti`.`Titolo`,`riassunti`.`UrlPDF`,`riassunti`.`UrlIMG`,`riassunti`.`Anno`,`riassunti`.`IDMateria`,`riassunti`.`DataPubblicazione` order by `Val`,`riassunti`.`DataPubblicazione` desc